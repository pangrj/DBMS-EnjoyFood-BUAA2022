# <center>任务一实验报告 </center>

## 1. 开发环境与技术说明

本数据库采用前端、后端、数据库分离的体系结构，数据库存储、管理数据；后端将数据库数据传送给前端、接收前端请求并且传递给数据库，使得数据库执行指令；前端与用户交互，显示数据库数据并且接收用户修改数据的请求。

### 1.1 开发语言

前端：使用HTML + CSS + JavaScript结合的方式来实现前端客户端页面 

后端：以 Java 作为基础开发语言，使用 SpringBoot 作为基本的开发框架

### 1.2 数据库管理系统

本数据库采用的数据库管理系统是MySQL



## 2. 数据库表的定义

​	数据库中共含有2个实体，共3张基本表。具体定义如下：

### 2.1 用户表

| 属性名     | 中文   | 数据类型 | 备注 |
| ---------- | ------ | -------- | ---- |
| s_id       | 用户名 | int      | 主码 |
| s_password | 密码   | string   |      |
| s_name     | 姓名   | string   |      |
| s_dorm     | 宿舍   | string   |      |
| s_gender   | 性别   | string   |      |

### 2.2 菜品表

| 属性名     | 中文       | 数据类型 | 备注 |
| ---------- | ---------- | -------- | ---- |
| d_id       | 菜品编号   | int      | 主码 |
| d_name     | 菜品名称   | string   |      |
| d_category | 菜品种类   | string   |      |
| d_cuisine  | 菜品风味   | string   |      |
| d_calories | 菜品卡路里 | int      |      |
| d_price    | 菜品价格   | int      |      |

### 2.3 用户选菜表

| 属性名 | 中文     | 数据类型 | 备注 |
| ------ | -------- | -------- | ---- |
| id     | 标识号   | int      | 主码 |
| s_id   | 用户编号 | int      |      |
| d_id   | 菜品编号 | int      |      |
| score  | 评分     | int      |      |
|        |          |          |      |

## 3. 数据库的连接方法与语句

后端使用spring boot框架，使用了 maven 作为打包工具进行部署。在spring boot框架中后端部分分为` Controller层 Dao层 Entity层  Service层 以及最底层的Mapper层` 后端功能所需要使用的 SQL 语句 XML 中， 通过 Mapper 来将各个字段填充到 SQL 语句 对应的参数位置中。

请求从前端发送过来具体过程为 Controller可以得到前端的请求并且进行处理，随后Controller层将处理后的后端请求发送到Service层，Service层再将请求发送至Dao层，Dao层运行Mapper中的SQL语句并且返回运行结果。

### 3.1 具体实现功能

说明：MySQL语句中形如` #{}`的部分为参数

1. 学生表相关操作

（1）插入新注册的学生

```mysql
insert into `student` (`s_id`, `s_password`) values (#{s_id}, #{s_password})
```

（2）通过学生ID查找学生

```mysql
select * from student where s_id = #{s_id}
```

（3）修改学生个人信息

```mysql
update `student`
        set s_password = #{s_password}, s_name = #{s_name}, s_dorm = #{s_dorm}, s_gender = #{s_gender}
        where s_id = #{s_id}
```

2. 菜品表相关操作

（1）通过菜品名称查找菜品

```mysql
select * from `dish` where d_name = #{d_name}
```

（2）查询所有的菜品信息

```mysql
select * from `dish`
```

（3）通过菜品编号查找菜品

```mysql
select * from `dish` where d_id = #{d_id}
```

（4）返回某用户所有未选择的菜品信息

```mysql
select *
from `dish`
where d_id not in
(select d_id
 from chose_menu
 where s_id = #{s_id})
```

（5）返回某用户所有已选择的菜品信息

```mysql
select *
from `dish`
where d_id in
(select d_id
 from chose_menu
 where s_id = #{s_id})
```

3. 选菜，取消选菜相关操作

（1）学生选菜

```mysql
insert into `chose_menu`
(id,s_id, d_id)
values (#{id},#{s_id},#{d_id})
```

（2）取消选菜

```mysql
DELETE FROM `chose_menu`
WHERE d_id = #{d_id} AND s_id = #{s_id}
```

（3）查询是否有某选菜信息

```mysql
SELECT * FROM `chose_menu`
WHERE d_id = #{d_id} AND s_id = #{s_id}
```





## 4. 功能截图

1. 用户登录

   * 登录界面：
   
   ![image-20221015091638698](pic\image-20221015091638698.png)
   
   - （**查**）后端结合学生表检查用户名和密码是否正确，否则拒绝登入：
   
   ![image-20221015092431753](pic\image-20221015092431753.png)
   
   - 密码正确，即将跳转到选菜界面：
   
   ![image-20221015092705344](pic\image-20221015092705344.png)

2. 用户选菜

   - （**查**）进入界面，根据菜品表和学生选菜表初始化展示所有该用户未选的菜品：

   ![image-20221015092855801](pic\image-20221015092855801.png)

   - （**增**）点击每一行菜品右侧的“选择菜品”操作按钮可进行选菜（截图中点击第一行“卤肉饭”），该记录加入到学生选菜表中；同时更新当前选择页面，显示所有未被选择的菜品：

   ![image-20221015093052516](pic\image-20221015093052516.png)

   ![image-20221015093144306](pic\image-20221015093144306.png)

   - （**查**）搜索栏输入可以按菜品名检索菜品并展示：

   ![image-20221015093430404](pic\image-20221015093430404.png)

   ![image-20221015093452480](pic\image-20221015093452480.png)

   - 点击右上角“查看与修改个人信息”按钮可跳转到个人信息页面。

3. 个人信息页面

   - （**查**）根据学生信息表和学生选菜表初始化展示用户信息表格以及已选菜品：

   ![image-20221015093703518](pic\image-20221015093703518.png)

   ![image-20221015093729827](pic\image-20221015093729827.png)

   * （**改**）填写个人信息栏并点击“提交信息更新”可以更新该学生信息（学号不可改），并对学生信息表进行修改：

   ![image-20221015093854483](pic\image-20221015093854483.png)

   * （**删**）点击已选菜品部分的“删除选菜”按钮可以删除该选择记录，并从学生选菜表中删除该记录，页面同步更新

   ![image-20221015094031344](pic\image-20221015094031344.png)

   ![image-20221015094057461](pic\image-20221015094057461.png)

   * （**查**）点击右上角的“返回菜品选择页面”可以回到菜品选择页面，对于菜品的展示与该同学未选择的菜品一致：

   ![image-20221015094244182](pic\image-20221015094244182.png)